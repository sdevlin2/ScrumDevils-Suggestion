<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Feedback</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500&display=swap" rel="stylesheet">
    <link href="style.css" rel="stylesheet">
    <script src="script.js"></script>

</head>
<body>

    <form>
        <!--what does it do when submitted? action-->
        <div class="feedback-container">
            <h1>Select Topic and Questions</h1>

            <div>
                <label for="topicSelect">Select Topic:</label>
                <select id="topicSelect"></select>
            </div>

            <div>
                <label for="questionSelect">Select Question:</label>
                <select id="questionSelect"></select>
            </div>

            <div>
                <textarea id="feedbackValue"></textarea>
                <input type="submit" value="Submit Feedback">
            </div>
            <div id="pointCounter">
                <h2>Points: <span id='numberCounter'></span></h2>
                <input type="button" value="Counts Points" onclick="pointCounter()"/>
            </div>
        </div>
    </form>

</body>
</html>

<script>

    // Get the topic from the dropdown and fetch questions based on topic.
    // Changing this to use topic id instead of topic name would be far more elegant. See GetQuestions service.
    document.getElementById("topicSelect").addEventListener("change", function () {
        var selectedTopic = this.value;
        fetchData("ProjectServices.asmx/GetQuestions?topicName=" + selectedTopic)
            .then(function (questions) {
                populateDropdown("questionSelect", questions);
            })
            .catch(function (error) {
                // Log an error message if fetching questions fails
                console.error('Error fetching questions:', error);
            });
    });

    // Fetch topics and populate the topics dropdown
    fetchData("ProjectServices.asmx/GetTopics")
        .then(function (topics) {
            populateDropdown("topicSelect", topics);
        })
        .catch(function (error) {
            console.error('Error fetching topics:', error);
        });


    </script>
